# Cyber Chef Receipe
This is a quick cyberchef receipe to extract defanged URLs from the maldocs that are used as the first stage of CVE-2021-40444's exploitation

```
https://gchq.github.io/CyberChef/#recipe=Unzip('',false)Extract_URLs(false)Regular_expression('User%20defined','(https?:%5C%5C/%5C%5C/(?!.*%5C%5C.?(microsoft%7Copenxmlformats%7Cpurl%7Cw3)).*)',true,true,false,false,false,false,'List%20matches')Defang_URL(true,true,true,'Valid%20domains%20and%20full%20URLs')
```

If you do not want to copy the link and paste it into the browser, this is the receipe, you can copy this and click on load receipe within cyber chef, then paste it in the *receipe* section and click **load**.

```
Unzip('',false)
Extract_URLs(false)
Regular_expression('User defined','(https?:\\/\\/(?!.*\\.?(microsoft|openxmlformats|purl|w3)).*)',true,true,false,false,false,false,'List matches')
Defang_URL(true,true,true,'Valid domains and full URLs')
```
## Sample File
This was tested using a doc file with a sha256 hash value of 938545f7bbe40738908a95da8cdeabb2a11ce2ca36b0f6a74deda9378d380a52. The sample was downloaded from [malware bazaar](https://bazaar.abuse.ch/sample/938545f7bbe40738908a95da8cdeabb2a11ce2ca36b0f6a74deda9378d380a52). 

![receipe test](./sample_run.PNG)
